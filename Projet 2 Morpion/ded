<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css"> 
    <title>Morpion</title>
    <script src="script.js"></script>
</head>
<body>
    <h1>Le Morpion</h1>
<form method="post" action="enregistrement_partie.php" name="monform">
    <?php
    session_start();
    include 'connect.php';
   $id = $_SESSION["id_user"];
    ?>
    <br>
    <table id="tableau">
        <tbody>
            <tr>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
            </tr>
            <tr>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
            </tr>
            <tr>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
                <td onclick="coloreCase(event)"></td>
            </tr>
        </tbody>
        <tfoot>
       
        <button id="nouvellePartie" onclick="monform.submit()">Nouvelle Partie</button>

            <button class="button-64" role="button"><a href="connexion.php" class="text">Déconnexion</a></button>

            
        </tfoot>
    </table>
    <input type="hidden" name="couleur"/>
</form>

    <div id="scores">
        <h2>Scores</h2>


        <?php
// Assurez-vous que $db soit votre connexion à la base de données

// Remplacez 11 par l'identifiant de l'utilisateur connecté
$id_utilisateur_connecte = 11; // Exemple : à remplacer par votre logique de récupération de l'ID utilisateur connecté

// Requête SQL pour récupérer le nombre de parties remportées par le vert
$sql_vert = "SELECT COUNT(*) AS score_vert
             FROM partie
             WHERE fk_id_user = :id AND couleur = 'vert'";

// Requête SQL pour récupérer le nombre de parties remportées par le rouge
$sql_rouge = "SELECT COUNT(*) AS score_rouge
              FROM partie
              WHERE fk_id_user = :id AND couleur = 'rouge'";

// Préparation et exécution de la requête SQL pour le vert
$stmt_vert = $bdd->prepare($sql_vert);
$stmt_vert->execute([':id' => $id_utilisateur_connecte]);
$row_vert = $stmt_vert->fetch(PDO::FETCH_ASSOC);
$scoreGreen = $row_vert['score_vert'];

// Préparation et exécution de la requête SQL pour le rouge
$stmt_rouge = $bdd->prepare($sql_rouge);
$stmt_rouge->execute([':id' => $id_utilisateur_connecte]);
$row_rouge = $stmt_rouge->fetch(PDO::FETCH_ASSOC);
$scoreRed = $row_rouge['score_rouge'];
?>


        <table>
            <tr>
                <th>Joueur</th>
                <th>Points</th>
            </tr>
            <tr>
                <td>Green</td>
                <td id="scoreGreen"><?= $scoreGreen ?></td>
            </tr>
            <tr>
                <td>Red</td>
                <td id="scoreRed"><?= $scoreRed  ?></td>
            </tr>
        </table>
    </div>
    
</body>
</html>
